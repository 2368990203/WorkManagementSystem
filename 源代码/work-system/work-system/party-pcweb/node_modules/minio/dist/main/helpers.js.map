{"version":3,"sources":["helpers.js"],"names":[],"mappings":"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","file":"helpers.js","sourcesContent":["/*\n * Minio Javascript Library for Amazon S3 Compatible Cloud Storage, (C) 2015 Minio, Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport stream from 'stream'\nimport mime from 'mime-types'\n\n// Returns a wrapper function that will promisify a given callback function.\n// It will preserve 'this'.\nexport function promisify(fn) {\n  return function() {\n    // If the last argument is a function, assume its the callback.\n    let callback = arguments[arguments.length - 1]\n\n    // If the callback is given, don't promisify, just pass straight in.\n    if (typeof callback === 'function') return fn.apply(this, arguments)\n\n    // Otherwise, create a new set of arguments, and wrap\n    // it in a promise.\n    let args = [...arguments]\n\n    return new Promise((resolve, reject) => {\n      // Add the callback function.\n      args.push((err, value) => {\n        if (err) return reject(err)\n\n        resolve(value)\n      })\n\n      // Call the function with our special adaptor callback added.\n      fn.apply(this, args)\n    })\n  }\n}\n\n// All characters in string which are NOT unreserved should be percent encoded.\n// Unreserved characers are : ALPHA / DIGIT / \"-\" / \".\" / \"_\" / \"~\"\n// Reference https://tools.ietf.org/html/rfc3986#section-2.2\nexport function uriEscape(string) {\n  return string.split('').reduce((acc, elem) => {\n    let buf = new Buffer(elem)\n    if (buf.length === 1) {\n      // length 1 indicates that elem is not a unicode character.\n      // Check if it is an unreserved characer.\n      if ('A' <= elem && elem <= 'Z' ||\n          'a' <= elem && elem <= 'z' ||\n          '0' <= elem && elem <= '9' ||\n          elem === '_' ||\n          elem === '.' ||\n          elem === '~' ||\n          elem === '-')\n      {\n        // Unreserved characer should not be encoded.\n        acc = acc + elem\n        return acc\n      }\n    }\n    // elem needs encoding - i.e elem should be encoded if it's not unreserved\n    // character or if it's a unicode character.\n    for (var i = 0; i < buf.length; i++) {\n      acc = acc + \"%\" + buf[i].toString(16).toUpperCase()\n    }\n    return acc\n  }, '')\n}\n\nexport function uriResourceEscape(string) {\n  return uriEscape(string).replace(/%2F/g, '/')\n}\n\nexport function getScope(region, date) {\n  return `${makeDateShort(date)}/${region}/s3/aws4_request`\n}\n\n// isAmazonEndpoint - true if endpoint is 's3.amazonaws.com' or 's3.cn-north-1.amazonaws.com.cn'\nexport function isAmazonEndpoint(endpoint) {\n  return endpoint === 's3.amazonaws.com' || endpoint === 's3.cn-north-1.amazonaws.com.cn'\n}\n\n// isVirtualHostStyle - verify if bucket name is support with virtual\n// hosts. bucketNames with periods should be always treated as path\n// style if the protocol is 'https:', this is due to SSL wildcard\n// limitation. For all other buckets and Amazon S3 endpoint we will\n// default to virtual host style.\nexport function isVirtualHostStyle(endpoint, protocol, bucket) {\n  if (protocol === 'https:' && bucket.indexOf('.') > -1) {\n    return false\n  }\n  return isAmazonEndpoint(endpoint)\n}\n\nvar ipv4Regex = /^(\\d{1,3}\\.){3,3}\\d{1,3}$/\n\nexport function isValidIP(ip) {\n  return ipv4Regex.test(ip)\n}\n\n// isValidEndpoint - true if endpoint is valid domain.\nexport function isValidEndpoint(endpoint) {\n  if (!isValidDomain(endpoint) && !isValidIP(endpoint)) {\n    return false\n  }\n  // Return true.\n  return true\n}\n\n// isValidDomain - true if input host is a valid domain.\nexport function isValidDomain(host) {\n  if (!isString(host)) return false\n  // See RFC 1035, RFC 3696.\n  if (host.length === 0 || host.length > 255) {\n    return false\n  }\n  // Host cannot start or end with a '-'\n  if (host[0] === '-' || host.substr(-1) === '-') {\n    return false\n  }\n  // Host cannot start or end with a '_'\n  if (host[0] === '_' || host.substr(-1) === '_') {\n    return false\n  }\n  // Host cannot start or end with a '.'\n  if (host[0] === '.' || host.substr(-1) === '.') {\n    return false\n  }\n  var alphaNumerics = '`~!@#$%^&*()+={}[]|\\\\\"\\';:><?/'.split('')\n  // All non alphanumeric characters are invalid.\n  for (var i in alphaNumerics) {\n    if (host.indexOf(alphaNumerics[i]) > -1) {\n      return false\n    }\n  }\n  // No need to regexp match, since the list is non-exhaustive.\n  // We let it be valid and fail later.\n  return true\n}\n\n// Probes contentType using file extensions.\n// For example: probeContentType('file.png') returns 'image/png'.\nexport function probeContentType(path) {\n  let contentType = mime.lookup(path)\n  if (!contentType) {\n    contentType = 'application/octet-stream'\n  }\n  return contentType\n}\n\n// isValidPort - is input port valid.\nexport function isValidPort(port) {\n  // verify if port is a number.\n  if (!isNumber(port)) return false\n  // port cannot be negative.\n  if (port < 0) return false\n  // port '0' is valid and special case return true.\n  if (port === 0) return true\n  var min_port = 1\n  var max_port = 65535\n  // Verify if port is in range.\n  return port >= min_port && port <= max_port\n}\n\nexport function isValidBucketName(bucket) {\n  if (!isString(bucket)) return false\n\n  // bucket length should be less than and no more than 63\n  // characters long.\n  if (bucket.length < 3 || bucket.length > 63) {\n    return false\n  }\n  // bucket with successive periods is invalid.\n  if (bucket.indexOf('..') > -1) {\n    return false\n  }\n  // bucket cannot have ip address style.\n  if (bucket.match(/[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+/)) {\n    return false\n  }\n  // bucket should begin with alphabet/number and end with alphabet/number,\n  // with alphabet/number/.- in the middle.\n  if (bucket.match(/^[a-z0-9][a-z0-9.-]+[a-z0-9]$/)) {\n    return true\n  }\n  return false\n}\n\n// check if objectName is a valid object name\nexport function isValidObjectName(objectName) {\n  if (!isValidPrefix(objectName)) return false\n  if (objectName.length === 0) return false\n  return true\n}\n\n// check if prefix is valid\nexport function isValidPrefix(prefix) {\n  if (!isString(prefix)) return false\n  if (prefix.length > 1024) return false\n  return true\n}\n\n// check if typeof arg number\nexport function isNumber(arg) {\n  return typeof(arg) === 'number'\n}\n\n// check if typeof arg function\nexport function isFunction(arg) {\n  return typeof(arg) === 'function'\n}\n\n// check if typeof arg string\nexport function isString(arg) {\n  return typeof(arg) === 'string'\n}\n\n// check if typeof arg object\nexport function isObject(arg) {\n  return typeof(arg) === 'object' && arg !== null\n}\n\n// check if object is readable stream\nexport function isReadableStream(arg) {\n  return isObject(arg) && isFunction(arg._read)\n}\n\n// check if arg is boolean\nexport function isBoolean(arg) {\n  return typeof(arg) === 'boolean'\n}\n\n// check if arg is array\nexport function isArray(arg) {\n  return Array.isArray(arg)\n}\n\n// check if arg is a valid date\nexport function isValidDate(arg) {\n  return arg instanceof Date && !isNaN(arg)\n}\n\n// Create a Date string with format:\n// 'YYYYMMDDTHHmmss' + Z\nexport function makeDateLong(date) {\n  date = date || new Date()\n\n  // Gives format like: '2017-08-07T16:28:59.889Z'\n  date = date.toISOString()\n\n  return date.substr(0, 4) +\n    date.substr(5, 2) +\n    date.substr(8, 5) +\n    date.substr(14, 2) +\n    date.substr(17, 2) + 'Z'\n}\n\n// Create a Date string with format:\n// 'YYYYMMDD'\nexport function makeDateShort(date) {\n  date = date || new Date()\n\n  // Gives format like: '2017-08-07T16:28:59.889Z'\n  date = date.toISOString()\n\n  return date.substr(0, 4) +\n    date.substr(5, 2) +\n    date.substr(8, 2)\n}\n\n// pipesetup sets up pipe() from left to right os streams array\n// pipesetup will also make sure that error emitted at any of the upstream Stream\n// will be emitted at the last stream. This makes error handling simple\nexport function pipesetup(...streams) {\n  return streams.reduce((src, dst) => {\n    src.on('error', err => dst.emit('error', err))\n    return src.pipe(dst)\n  })\n}\n\n// return a Readable stream that emits data\nexport function readableStream(data) {\n  var s = new stream.Readable()\n  s._read = () => {}\n  s.push(data)\n  s.push(null)\n  return s\n}\n// Function prepends metadata with the appropriate prefix if it is not already on\nexport function prependXAMZMeta(metaData) {\n  var newMetadata = Object.assign({}, metaData)\n  for (var key in metaData) {\n    if(!isAmzHeader(key) && !isSupportedHeader(key) && !isStorageclassHeader(key)) {\n      newMetadata[\"X-Amz-Meta-\" + key ] = newMetadata[key]\n      delete newMetadata[key]\n    }\n  }\n  return newMetadata\n}\n\n// Checks if it is a valid header according to the AmazonS3 API\nexport function isAmzHeader(key) {\n  var temp = key.toLowerCase()\n  return temp.startsWith(\"x-amz-meta-\") || temp === \"x-amz-acl\" || temp.startsWith(\"x-amz-server-side-encryption-\") || temp === \"x-amz-server-side-encryption\"\n}\n//Checks if it is a supported Header\nexport function isSupportedHeader(key) {\n  var supported_headers = [\n    'content-type',\n    'cache-control',\n    'content-encoding',\n    'content-disposition',\n    'content-language',\n    'x-amz-website-redirect-location']\n  return (supported_headers.indexOf(key.toLowerCase()) > -1)\n}\n//Checks if it is a storage header\nexport function isStorageclassHeader(key) {\n  return key.toLowerCase() === \"x-amz-storage-class\"\n}\n\nexport function extractMetadata(metaData) {\n  var newMetadata = {}\n  for (var key in metaData) {\n    if(isSupportedHeader(key) || isStorageclassHeader(key) || isAmzHeader(key)) {\n      if(key.toLowerCase().startsWith(\"x-amz-meta-\")) {\n        newMetadata[key.slice(11,key.length)] = metaData[key]\n      } else {\n        newMetadata[key] = metaData[key]\n      }\n    }\n  }\n  return newMetadata\n}\n"]}